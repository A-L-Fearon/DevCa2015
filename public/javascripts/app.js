// Generated by CoffeeScript 1.9.1
(function() {
  'use strict';
  angular.module('BudgetApp', [], function() {});

  angular.module('BudgetApp').controller('globalCtrl', [
    '$scope', '$http', '$q', function($scope, $http, $q) {
      $scope["switch"] = false;
      $scope.dislikes = [];
      $scope.switchF = function() {
        console.log($scope);
        $scope.$parent["switch"] = !$scope["switch"];
        return $scope["switch"] = $scope.$parent["switch"];
      };
      $scope.items = [];
      $scope.stores = [
        {
          name: 'Store Name',
          type: "Wholesale",
          number: "465-1234",
          address: "4 FkThisShit Dr. Kingston 69"
        }, {
          name: 'Store Name',
          type: "Wholesale",
          number: "465-1234",
          address: "4 FkThisShit Dr. Kingston 69"
        }, {
          name: 'Store Name',
          type: "Wholesale",
          number: "465-1234",
          address: "4 FkThisShit Dr. Kingston 69"
        }
      ];
      $scope.init = function() {
        var cityCircle, map, mapOptions, marker, myLatlng, populationOptions;
        mapOptions = {
          center: {
            lat: -34.397,
            lng: 150.644
          },
          zoom: 8
        };
        map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
        myLatlng = new google.maps.LatLng(-34.397, 150.644);
        marker = new google.maps.Marker({
          position: myLatlng,
          map: map,
          title: "Hello World!"
        });
        populationOptions = {
          strokeColor: '#FF0000',
          strokeOpacity: 0.8,
          strokeWeight: 2,
          fillColor: '#FF0000',
          fillOpacity: 0.35,
          map: map,
          center: myLatlng,
          radius: 10000
        };
        cityCircle = new google.maps.Circle(populationOptions);
        return $scope.foods = {
          "Red peas": {
            "name": "Red peas",
            "calories": 219,
            "protein": 16,
            "carbohydrates": 40,
            "sodium": 7,
            "sugar": 0,
            "Saturated Fat": 0,
            "Fat": 0,
            "calcium": 12,
            "vitamin A": 0,
            "vitamin C": 4,
            "iron": 29,
            "price": 120
          },
          "Tomatoes": {
            "name": "Tomatoes",
            "calories": 27,
            "protein": 1,
            "carbohydrates": 6,
            "sodium": 7,
            "sugar": 4,
            "Saturated Fat": 0,
            "Fat": 0,
            "calcium": 1,
            "vitamin A": 25,
            "vitamin C": 32,
            "iron": 2,
            "price": 65
          },
          "Broad Beans": {
            "name": "Broad Beans",
            "calories": 187,
            "protein": 13,
            "carbohydrates": 33,
            "sodium": 9,
            "sugar": 3,
            "Saturated Fat": 0,
            "Fat": 1,
            "calcium": 6,
            "vitamin A": 1,
            "vitamin C": 1,
            "iron": 14,
            "price": 134
          },
          "Ripe Banana": {
            "name": "Ripe Banana",
            "calories": 200,
            "protein": 2,
            "carbohydrates": 51,
            "sodium": 2,
            "sugar": 28,
            "Saturated Fat": 0,
            "Fat": 1,
            "calcium": 1,
            "vitamin A": 3,
            "vitamin C": 33,
            "iron": 3,
            "price": 30
          },
          "Sweet Potato": {
            "name": "Sweet Potato",
            "calories": 180,
            "protein": 4,
            "carbohydrates": 41,
            "sodium": 72,
            "sugar": 13,
            "Saturated Fat": 0,
            "Fat": 0,
            "calcium": 8,
            "vitamin A": 40,
            "vitamin C": 60,
            "iron": 8,
            "price": 200
          },
          "Vienna Sausage": {
            "name": "Vienna Sausage",
            "calories": 37,
            "protein": 2,
            "carbohydrates": 0,
            "sodium": 155,
            "sugar": 0,
            "Saturated Fat": 1,
            "Fat": 3,
            "calcium": 0,
            "vitamin A": 0,
            "vitamin C": 0,
            "iron": 1,
            "price": 10
          },
          "Mackerel": {
            "name": "Mackerel",
            "calories": 230,
            "protein": 21,
            "carbohydrates": 0,
            "sodium": 101,
            "sugar": 0,
            "Saturated Fat": 4,
            "Fat": 16,
            "calcium": 1,
            "vitamin A": 4,
            "vitamin C": 1,
            "iron": 10,
            "price": 50
          },
          "Sardines": {
            "name": "Sardines",
            "calories": 310,
            "protein": 37,
            "carbohydrates": 0,
            "sodium": 752,
            "sugar": 0,
            "Saturated Fat": 2,
            "Fat": 17,
            "calcium": 57,
            "vitamin A": 3,
            "vitamin C": 0,
            "iron": 24,
            "price": 50
          },
          "Rice": {
            "name": "Rice",
            "calories": 216,
            "protein": 5,
            "carbohydrates": 451,
            "sodium": 10,
            "sugar": 1,
            "Saturated Fat": 0,
            "Fat": 2,
            "calcium": 2,
            "vitamin A": 0,
            "vitamin C": 0,
            "iron": 5,
            "price": 80
          },
          "Cornmeal": {
            "name": "Cornmeal",
            "calories": 108,
            "protein": 3,
            "carbohydrates": 20,
            "sodium": 1,
            "sugar": 0,
            "Saturated Fat": 0,
            "Fat": 2,
            "calcium": 0,
            "vitamin A": 0,
            "vitamin C": 0,
            "iron": 5,
            "price": 40
          },
          "Chicken": {
            "name": "Chicken",
            "calories": 164,
            "protein": 25,
            "carbohydrates": 0,
            "sodium": 330,
            "sugar": 0,
            "Saturated Fat": 1.8,
            "Fat": 6.48,
            "calcium": 1,
            "vitamin A": 0,
            "vitamin C": 0,
            "iron": 5,
            "price": 270
          },
          "Bread": {
            "name": "Bread",
            "calories": 69,
            "protein": 4,
            "carbohydrates": 12,
            "sodium": 132,
            "sugar": 2,
            "saturated Fat": 0,
            "fat": 1,
            "calcium": 3,
            "vitamin A": 0,
            "vitamin C": 0,
            "iron": 4,
            "price": 23
          },
          "Eggs": {
            "name": "Eggs",
            "calories": 75,
            "protein": 7,
            "carbohydrates": 0.38,
            "sodium": 70,
            "sugar": 0,
            "saturated Fat": 8,
            "fat": 4.97,
            "calcium": 3,
            "vitamin A": 0,
            "vitamin C": 0,
            "iron": 5,
            "price": 25
          }
        };
      };
      $scope.sendList = function() {
        console.log($scope);
        $http.post("/api/list", $scope.items).
                            success(function(data, status, headers, config) {
        						console.log(data);

        					}).error(function(data, status, headers, config) {
                                // called asynchronously if an error occurs
                                // or server returns response with an error status.
                                console.log(data);
                                console.log(status);
                                console.log(headers);
                                console.log(config);
                            });;
      };
      $scope.addItem = function(item) {
        $scope.items.push({
          name: item
        });
        $scope.$parent.newItem = "";
        $scope.newItem = "";
        console.log($scope);
      };
      $scope.addDislike = function(dislike) {
        $scope.dislikes.push({
          name: dislike
        });
        $scope.$parent.newDislike = "";
        $scope.newDislike = "";
      };
      $scope.calculateBudget = function(budget) {
        var i, j, len, model, ref, results, solver;
        ref = $scope.dislikes;
        for (j = 0, len = ref.length; j < len; j++) {
          i = ref[j];
          delete $scope.foods[i];
          console.log($scope.foods);
        }
        solver = new Solver;
        model = {
          "optimize": "price",
          "opType": "min",
          "constraints": {
            "calories": {
              "min": 1800 * 7,
              "max": 2400 * 7
            },
            "protein": {
              "min": 50 * 7
            },
            "carbohydrates": {
              "min": 310 * 7
            },
            "sodium": {
              "min": 1500 * 7,
              "max": 2300 * 7
            },
            "sugar": {
              "min": 30 * 7
            },
            "Saturated Fat": {
              "min": 24 * 7,
              "max": 50 * 7
            },
            "Fat": {
              "min": 70 * 7
            },
            "calcium": {
              "min": 80 * 7,
              "max": "100"
            },
            "vitamin A": {
              "min": 80 * 7,
              "max": "100"
            },
            "vitamin C": {
              "min": 80 * 7,
              "max": "100"
            },
            "iron": {
              "min": 80 * 7,
              "max": "100"
            },
            "price": {
              "max": budget
            }
          },
          "variables": $scope.foods
        };
        results = solver.Solve(model);
        $scope.results = results;
        $scope.resKeys = Object.keys(results);
        console.log($scope);
        return console.log(results);
      };
      return $scope.init();
    }
  ]);

}).call(this);
